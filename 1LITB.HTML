<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>El Barril de Amontillado: Infograf√≠a y Crucigrama</title>
    <!-- Tailwind CSS CDN para un estilo moderno y responsivo -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Creepster&display=swap" rel="stylesheet">
    <style>
        /* Estilos personalizados para la atm√≥sfera del cuento */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1a1a1a; /* Fondo oscuro */
            color: #e0e0e0; /* Texto claro */
            line-height: 1.6;
        }
        .font-creepy {
            font-family: 'Creepster', cursive; /* Fuente para t√≠tulos dram√°ticos */
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1.5rem;
        }
        .card {
            background-color: #2c2c2c; /* Fondo de tarjeta m√°s claro */
            border-radius: 0.75rem; /* Bordes redondeados */
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        .accordion-header {
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
            border-bottom: 1px solid #444;
        }
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
            padding-top: 0.5rem;
        }
        .accordion-content.active {
            max-height: 500px; /* Suficiente para expandir el contenido */
            transition: max-height 0.5s ease-in;
        }
        .icon {
            font-size: 1.5rem; /* Tama√±o de los iconos emoji */
        }

        /* Estilos para el Crucigrama */
        #crossword-grid {
            display: grid;
            grid-template-columns: repeat(12, 35px); /* Ajusta el tama√±o de las celdas */
            grid-template-rows: repeat(12, 35px);
            gap: 1px;
            background-color: #444;
            border: 2px solid #555;
            margin: 2rem auto;
            max-width: fit-content;
        }
        .crossword-cell {
            width: 35px;
            height: 35px;
            background-color: #333;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.2rem;
            font-weight: bold;
            color: #eee;
            border: 1px solid #555;
            position: relative;
        }
        .crossword-cell input {
            width: 100%;
            height: 100%;
            text-align: center;
            background-color: #555;
            border: none;
            color: #eee;
            font-size: 1.2rem;
            text-transform: uppercase;
            outline: none;
            caret-color: transparent; /* Oculta el cursor de texto */
        }
        .crossword-cell input:focus {
            background-color: #666;
            box-shadow: 0 0 0 2px #888;
        }
        .crossword-cell.empty {
            background-color: #1a1a1a;
            border: 1px solid #1a1a1a;
        }
        .clue-number {
            position: absolute;
            top: 2px;
            left: 2px;
            font-size: 0.7rem;
            color: #ccc;
            font-weight: normal;
        }
        .clues-section {
            display: flex;
            flex-wrap: wrap;
            gap: 2rem;
            justify-content: center;
            margin-top: 2rem;
        }
        .clues-list {
            background-color: #2c2c2c;
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            flex: 1 1 45%; /* Permite que se organicen en dos columnas */
            min-width: 280px;
        }
        .clues-list h4 {
            font-size: 1.5rem;
            font-weight: bold;
            color: #a78bfa; /* Morado claro */
            margin-bottom: 1rem;
        }
        .clues-list ol {
            list-style-position: inside;
            padding-left: 0;
        }
        .clues-list li {
            margin-bottom: 0.5rem;
            color: #ccc;
        }
        .correct-word input {
            background-color: #22c55e !important; /* Verde para respuestas correctas */
            color: #fff !important;
        }
        .incorrect-word input {
            background-color: #ef4444 !important; /* Rojo para respuestas incorrectas */
            color: #fff !important;
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-100">
    <div class="container">
        <!-- Encabezado Principal -->
        <header class="text-center py-8">
            <h1 class="text-5xl md:text-6xl font-creepy text-red-600 mb-4 animate-pulse">El Barril de Amontillado</h1>
            <p class="text-xl md:text-2xl text-gray-300">Recursos Din√°micos para el Aula de Lengua y Literatura</p>
            <p class="mt-4 text-gray-400">¬°Prep√°rense para desentra√±ar el misterio de Edgar Allan Poe como nunca antes!</p>
        </header>

        <!-- Secci√≥n de Res√∫menes Visuales: La "Story" del Amontillado -->
        <section class="mb-12">
            <h2 class="text-4xl font-bold text-yellow-500 mb-6 text-center">1. La "Story" del Amontillado</h2>
            <p class="text-lg text-gray-300 mb-8 text-center">Imaginemos la historia como una serie de "Stories" de Instagram o TikTok. Cada una, un momento clave con un dise√±o que ¬°salta a la vista!</p>

            <!-- Tarjeta de cada "Story" -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Story 1: La Chispa de la Venganza -->
                <div class="card">
                    <h3 class="text-2xl font-bold text-red-500 mb-2 flex items-center"><span class="icon mr-2">üí•</span> La Chispa de la Venganza</h3>
                    <p class="text-gray-300">Montresor ya no aguanta m√°s las "mil injurias" de Fortunato. Pero hay una en particular que lo quiebra. ¬øCu√°l fue? La historia no lo dice, ¬°pero la venganza ya es un hecho!</p>
                    <div class="mt-4 flex justify-center">
                        <img src="https://placehold.co/150x100/333/eee?text=Ojo+Vengador" alt="Ojo con chispa roja" class="rounded-lg shadow-md">
                    </div>
                    <p class="text-center text-gray-400 mt-2">Icono: üíÄ o üó°Ô∏è</p>
                </div>

                <!-- Story 2: El Plan Perfecto: Impunidad y Sutilidad -->
                <div class="card">
                    <h3 class="text-2xl font-bold text-blue-400 mb-2 flex items-center"><span class="icon mr-2">ü§´</span> El Plan Perfecto: Impunidad y Sutilidad</h3>
                    <p class="text-gray-300">Montresor no solo quiere castigar, ¬°quiere castigar *sin que nadie lo descubra*! Y lo m√°s retorcido: Fortunato no tiene *ni idea* de que Montresor le guarda rencor. ¬°Montresor sigue sonriendo en su cara!</p>
                    <div class="mt-4 flex justify-center">
                        <img src="https://placehold.co/150x100/333/eee?text=Rostro+Sombra" alt="Rostro sonriente con sombra" class="rounded-lg shadow-md">
                    </div>
                    <p class="text-center text-gray-400 mt-2">Icono: üé≠ o ‚öôÔ∏è</p>
                </div>

                <!-- Story 3: El Carnaval: La Trampa Disfrazada -->
                <div class="card">
                    <h3 class="text-2xl font-bold text-green-400 mb-2 flex items-center"><span class="icon mr-2">üéâ</span> El Carnaval: La Trampa Disfrazada</h3>
                    <p class="text-gray-300">En pleno Carnaval (¬°la fiesta del desenfreno y las m√°scaras!), Montresor encuentra a Fortunato, borracho y disfrazado de payaso. La excusa perfecta: "¬°Recib√≠ un barril de *amontillado* y tengo dudas!"</p>
                    <div class="mt-4 flex justify-center">
                        <img src="https://placehold.co/150x100/333/eee?text=Antifaz+Barril" alt="Antifaz y barril de vino" class="rounded-lg shadow-md">
                    </div>
                    <p class="text-center text-gray-400 mt-2">Icono: üç∑ o ü•≥</p>
                </div>

                <!-- Story 4: Fortunato: El Vino y el Ego -->
                <div class="card">
                    <h3 class="text-2xl font-bold text-purple-400 mb-2 flex items-center"><span class="icon mr-2">üëë</span> Fortunato: El Vino y el Ego</h3>
                    <p class="text-gray-300">Fortunato es un conocedor de vinos (o eso cree). Montresor lo sabe y usa esa "pasi√≥n" como cebo. ¬øMencionar a Luchesi? ¬°La competencia despierta su orgullo!</p>
                    <div class="mt-4 flex justify-center">
                        <img src="https://placehold.co/150x100/333/eee?text=Copa+Borr√≥n" alt="Copa de vino con figura borrosa" class="rounded-lg shadow-md">
                    </div>
                    <p class="text-center text-gray-400 mt-2">Icono: üçá o üëë</p>
                </div>

                <!-- Story 5: Bajo Tierra: Las Catacumbas -->
                <div class="card">
                    <h3 class="text-2xl font-bold text-gray-400 mb-2 flex items-center"><span class="icon mr-2">‚¨áÔ∏è</span> Bajo Tierra: Las Catacumbas</h3>
                    <p class="text-gray-300">Fortunato, con su disfraz de payaso y sus cascabeles, sigue a Montresor hasta las catacumbas de su familia. ¬°Qu√© fr√≠o, qu√© humedad, qu√© salitre! Pero el "amontillado" es m√°s fuerte que el resfr√≠o.</p>
                    <div class="mt-4 flex justify-center">
                        <img src="https://placehold.co/150x100/333/eee?text=Entrada+Catacumba" alt="Entrada oscura a una catacumba" class="rounded-lg shadow-md">
                    </div>
                    <p class="text-center text-gray-400 mt-2">Icono: ü™ú o ‚ö∞Ô∏è</p>
                </div>

                <!-- Story 6: La √öltima Copa: El Medoc y el Secreto Mas√≥n -->
                <div class="card">
                    <h3 class="text-2xl font-bold text-orange-400 mb-2 flex items-center"><span class="icon mr-2">ü•Ç</span> La √öltima Copa: El Medoc y el Secreto Mas√≥n</h3>
                    <p class="text-gray-300">Montresor le da vino (medoc y De Grave) para la tos y para seguir "lubricando" la trampa. Fortunato, cada vez m√°s ebrio, hace un gesto mas√≥n... y Montresor responde con una paleta de alba√±il. ¬°La iron√≠a!</p>
                    <div class="mt-4 flex justify-center">
                        <img src="https://placehold.co/150x100/333/eee?text=Copas+Paleta" alt="Manos chocando copas con paleta oculta" class="rounded-lg shadow-md">
                    </div>
                    <p class="text-center text-gray-400 mt-2">Icono: üçæ o üß±</p>
                </div>

                <!-- Story 7: El Nicho Final: No Hay Salida -->
                <div class="card">
                    <h3 class="text-2xl font-bold text-red-600 mb-2 flex items-center"><span class="icon mr-2">‚õìÔ∏è</span> El Nicho Final: No Hay Salida</h3>
                    <p class="text-gray-300">Llegan a un nicho escondido. "¬°Aqu√≠ est√° el amontillado!" Y en un instante, ¬°Fortunato est√° encadenado! Montresor saca su paleta y empieza a levantar una pared de ladrillos y mortero. ¬°El p√°nico se apodera de Fortunato!</p>
                    <div class="mt-4 flex justify-center">
                        <img src="https://placehold.co/150x100/333/eee?text=Agujero+Cadenas" alt="Agujero oscuro con cadenas" class="rounded-lg shadow-md">
                    </div>
                    <p class="text-center text-gray-400 mt-2">Icono: üîó o üöß</p>
                </div>

                <!-- Story 8: Los Gritos y el Silencio -->
                <div class="card">
                    <h3 class="text-2xl font-bold text-pink-400 mb-2 flex items-center"><span class="icon mr-2">üò±</span> Los Gritos y el Silencio</h3>
                    <p class="text-gray-300">Fortunato grita, sacude las cadenas, y Montresor lo imita, ¬°se burla de su desesperaci√≥n! La risa se convierte en un suspiro. Luego, el silencio. ¬°Solo los cascabeles suenan por √∫ltima vez!</p>
                    <div class="mt-4 flex justify-center">
                        <img src="https://placehold.co/150x100/333/eee?text=M√°scara+Horror" alt="M√°scara de payaso con expresi√≥n de horror" class="rounded-lg shadow-md">
                    </div>
                    <p class="text-center text-gray-400 mt-2">Icono: üó£Ô∏è o üîá</p>
                </div>

                <!-- Story 9: El Legado del Crimen -->
                <div class="card">
                    <h3 class="text-2xl font-bold text-gray-500 mb-2 flex items-center"><span class="icon mr-2">‚è≥</span> El Legado del Crimen</h3>
                    <p class="text-gray-300">La pared est√° completa. Montresor termina su "obra" y deja los huesos de los Montresor cubriendo el lugar. Nadie ha tocado esa pared en medio siglo. "¬°In pace requiescat!" (¬°Que descanse en paz!)</p>
                    <div class="mt-4 flex justify-center">
                        <img src="https://placehold.co/150x100/333/eee?text=Muro+Calavera" alt="Muro de ladrillos con calavera" class="rounded-lg shadow-md">
                    </div>
                    <p class="text-center text-gray-400 mt-2">Icono: üîí o üóìÔ∏è</p>
                </div>
            </div>
        </section>

        <!-- Secci√≥n de Infograf√≠a Interactiva: El Mapa Mental de la Venganza -->
        <section class="mb-12">
            <h2 class="text-4xl font-bold text-yellow-500 mb-6 text-center">2. Infograf√≠a Interactiva: El Mapa Mental de la Venganza</h2>
            <p class="text-lg text-gray-300 mb-8 text-center">Explora la mente de Montresor y el desarrollo de su plan en este mapa conceptual interactivo.</p>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="card">
                    <div class="accordion-header" onclick="toggleAccordion(this)">
                        <h3 class="text-2xl font-bold text-red-500 flex items-center"><span class="icon mr-2">üíî</span> LA INJURIA IGNORADA</h3>
                        <span class="text-3xl toggle-icon">+</span>
                    </div>
                    <div class="accordion-content">
                        <p class="text-gray-300">Montresor sufre "mil injurias" de Fortunato, pero el "insulto" final es lo que desata su sed de venganza.</p>
                        <p class="text-gray-400 mt-2">**M√°s sobre la Injuria:** La venganza de Montresor se basa en la necesidad de castigar sin ser descubierto y asegurarse de que la v√≠ctima sepa qui√©n es su vengador.</p>
                    </div>
                </div>

                <div class="card">
                    <div class="accordion-header" onclick="toggleAccordion(this)">
                        <h3 class="text-2xl font-bold text-blue-400 flex items-center"><span class="icon mr-2">‚öñÔ∏è</span> CASTIGAR IMPUNEMENTE</h3>
                        <span class="text-3xl toggle-icon">+</span>
                    </div>
                    <div class="accordion-content">
                        <p class="text-gray-300">La venganza solo vale si: 1) El castigo no perjudica al vengador. 2) La v√≠ctima sabe qui√©n lo veng√≥. 3) Montresor sonr√≠e mientras planea la muerte.</p>
                        <p class="text-gray-400 mt-2">**La Mente de Montresor:** Su frialdad y c√°lculo son clave para ejecutar su plan sin remordimientos aparentes.</p>
                    </div>
                </div>

                <div class="card">
                    <div class="accordion-header" onclick="toggleAccordion(this)">
                        <h3 class="text-2xl font-bold text-yellow-400 flex items-center"><span class="icon mr-2">üç∑</span> FORTUNATO: EGO Y VINO</h3>
                        <span class="text-3xl toggle-icon">+</span>
                    </div>
                    <div class="accordion-content">
                        <p class="text-gray-300">Orgulloso conocedor de vinos, vanidoso (especialmente si lo comparan con Luchesi), y borracho en Carnaval, lo que lo vuelve vulnerable.</p>
                        <p class="text-gray-400 mt-2">**Puntos D√©biles:** Su vanidad y su afici√≥n al vino son explotadas magistralmente por Montresor.</p>
                    </div>
                </div>

                <div class="card">
                    <div class="accordion-header" onclick="toggleAccordion(this)">
                        <h3 class="text-2xl font-bold text-green-400 flex items-center"><span class="icon mr-2">üé≠</span> EL CARNAVAL Y EL 'AMONTILLADO'</h3>
                        <span class="text-3xl toggle-icon">+</span>
                    </div>
                    <div class="accordion-content">
                        <p class="text-gray-300">La atm√≥sfera de fiesta y disfraces facilita el enga√±o. La excusa del "barril de amontillado" es irresistible para Fortunato.</p>
                        <p class="text-gray-400 mt-2">**El Cebo Perfecto:** El "amontillado" es la trampa ideal para atraer a Fortunato a las catacumbas.</p>
                    </div>
                </div>

                <div class="card">
                    <div class="accordion-header" onclick="toggleAccordion(this)">
                        <h3 class="text-2xl font-bold text-gray-400 flex items-center"><span class="icon mr-2">üíÄ</span> LAS CATACUMBAS DE LOS MONTRESORS</h3>
                        <span class="text-3xl toggle-icon">+</span>
                    </div>
                    <div class="accordion-content">
                        <p class="text-gray-300">H√∫medas, cubiertas de salitre, laber√≠nticas y oscuras, llenas de huesos humanos. Criados ausentes por Carnaval.</p>
                        <p class="text-gray-400 mt-2">**Un Tour por las Catacumbas:** El ambiente opresivo y l√∫gubre contribuye a la tensi√≥n y el terror del relato.</p>
                    </div>
                </div>

                <div class="card">
                    <div class="accordion-header" onclick="toggleAccordion(this)">
                        <h3 class="text-2xl font-bold text-amber-600 flex items-center"><span class="icon mr-2">ü§´</span> MANIPULACI√ìN MAESTRA</h3>
                        <span class="text-3xl toggle-icon">+</span>
                    </div>
                    <div class="accordion-content">
                        <p class="text-gray-300">Elogios falsos, mencionar a Luchesi, preocupaci√≥n fingida, vino para la tos, el juego de la masoner√≠a, la trampa final.</p>
                        <p class="text-gray-400 mt-2">**Cronolog√≠a del Enga√±o:** Cada paso de Montresor est√° fr√≠amente calculado para llevar a Fortunato a su destino final.</p>
                    </div>
                </div>

                <div class="card">
                    <div class="accordion-header" onclick="toggleAccordion(this)">
                        <h3 class="text-2xl font-bold text-red-600 flex items-center"><span class="icon mr-2">üß±</span> EL MURO FINAL</h3>
                        <span class="text-3xl toggle-icon">+</span>
                    </div>
                    <div class="accordion-content">
                        <p class="text-gray-300">Fortunato encadenado. Se levanta la pared. Gritos de horror y desesperaci√≥n. Risas y silencio.</p>
                        <p class="text-gray-400 mt-2">**Momentos de Tensi√≥n:** "¬°Por el amor de Dios, Montresor!" y el sonido final de los cascabeles.</p>
                    </div>
                </div>

                <div class="card">
                    <div class="accordion-header" onclick="toggleAccordion(this)">
                        <h3 class="text-2xl font-bold text-gray-500 flex items-center"><span class="icon mr-2">üï∞Ô∏è</span> UN SECRETO DE MEDIO SIGLO</h3>
                        <span class="text-3xl toggle-icon">+</span>
                    </div>
                    <div class="accordion-content">
                        <p class="text-gray-300">El crimen perfecto. Impunidad total. Montresor vive con su secreto. "¬°In pace requiescat!"</p>
                        <p class="text-gray-400 mt-2">**El Legado del Silencio:** La frialdad de Montresor al relatar los hechos 50 a√±os despu√©s.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Secci√≥n de Crucigrama -->
        <section class="mb-12">
            <h2 class="text-4xl font-bold text-yellow-500 mb-6 text-center">3. Actividad: Crucigrama del Amontillado</h2>
            <p class="text-lg text-gray-300 mb-8 text-center">¬°Pon a prueba tu conocimiento del cuento resolviendo este misterioso crucigrama!</p>

            <div class="flex flex-col lg:flex-row gap-8 justify-center items-start">
                <div id="crossword-grid" class="flex-shrink-0">
                    <!-- El crucigrama se genera aqu√≠ con JavaScript -->
                </div>

                <div class="clues-section flex-grow">
                    <div class="clues-list">
                        <h4>Horizontales</h4>
                        <ol id="clues-across"></ol>
                    </div>
                    <div class="clues-list">
                        <h4>Verticales</h4>
                        <ol id="clues-down"></ol>
                    </div>
                </div>
            </div>
            <div class="text-center mt-8">
                <button id="checkCrosswordBtn" class="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition duration-300 ease-in-out transform hover:scale-105 mr-4">
                    Comprobar
                </button>
                <button id="resetCrosswordBtn" class="bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition duration-300 ease-in-out transform hover:scale-105">
                    Reiniciar
                </button>
            </div>
        </section>
    </div>

    <script>
        // JavaScript para la funcionalidad de los acordeones en la infograf√≠a
        function toggleAccordion(header) {
            const content = header.nextElementSibling;
            const toggleIcon = header.querySelector('.toggle-icon');

            if (content.classList.contains('active')) {
                content.classList.remove('active');
                content.style.maxHeight = '0';
                toggleIcon.textContent = '+';
            } else {
                // Cierra todos los dem√°s acordeones antes de abrir este
                document.querySelectorAll('.accordion-content.active').forEach(item => {
                    item.classList.remove('active');
                    item.style.maxHeight = '0';
                    item.previousElementSibling.querySelector('.toggle-icon').textContent = '+';
                });

                content.classList.add('active');
                content.style.maxHeight = content.scrollHeight + 'px'; // Ajusta la altura din√°micamente
                toggleIcon.textContent = '-';
            }
        }

        // --- L√≥gica del Crucigrama ---
        const crosswordData = [
            { id: 1, word: "MONTRESOR", clue: "El narrador y vengador de la historia.", direction: "across", start_x: 0, start_y: 1 },
            { id: 2, word: "FORTUNATO", clue: "La v√≠ctima, un supuesto experto en vinos.", direction: "down", start_x: 1, start_y: 0 },
            { id: 3, word: "AMONTILLADO", clue: "El tipo de vino que sirve de cebo.", direction: "across", start_x: 2, start_y: 3 },
            { id: 4, word: "CARNAVAL", clue: "La festividad donde Montresor encuentra a Fortunato.", direction: "down", start_x: 4, start_y: 2 },
            { id: 5, word: "CATACUMBAS", clue: "El oscuro lugar donde se desarrolla el crimen.", direction: "across", start_x: 5, start_y: 5 },
            { id: 6, word: "SALITRE", clue: "Sustancia que cubre las paredes de las catacumbas.", direction: "down", start_x: 6, start_y: 4 },
            { id: 7, word: "PAYASO", clue: "El disfraz que lleva Fortunato.", direction: "across", start_x: 7, start_y: 7 },
            { id: 8, word: "VENGANZA", clue: "El motivo principal de Montresor.", direction: "down", start_x: 8, start_y: 6 },
            { id: 9, word: "PALETA", clue: "La herramienta de alba√±il que Montresor usa para el muro.", direction: "across", start_x: 9, start_y: 9 },
            { id: 10, word: "LUCHESI", clue: "El rival de Fortunato, tambi√©n catador de vinos.", direction: "down", start_x: 10, start_y: 8 }
        ];

        const GRID_SIZE = 12; // Cuadr√≠cula de 12x12
        const crosswordGridElement = document.getElementById('crossword-grid');
        const cluesAcrossElement = document.getElementById('clues-across');
        const cluesDownElement = document.getElementById('clues-down');
        const checkCrosswordBtn = document.getElementById('checkCrosswordBtn');
        const resetCrosswordBtn = document.getElementById('resetCrosswordBtn');

        let grid = Array(GRID_SIZE).fill(null).map(() => Array(GRID_SIZE).fill(null));

        function generateCrosswordGrid() {
            crosswordGridElement.innerHTML = ''; // Limpiar la cuadr√≠cula existente
            grid = Array(GRID_SIZE).fill(null).map(() => Array(GRID_SIZE).fill(null)); // Resetear la matriz

            // Crear celdas vac√≠as
            for (let r = 0; r < GRID_SIZE; r++) {
                for (let c = 0; c < GRID_SIZE; c++) {
                    const cell = document.createElement('div');
                    cell.classList.add('crossword-cell', 'empty');
                    cell.dataset.row = r;
                    cell.dataset.col = c;
                    crosswordGridElement.appendChild(cell);
                }
            }

            // Colocar palabras en la cuadr√≠cula
            crosswordData.forEach(wordData => {
                const { id, word, direction, start_x, start_y } = wordData;
                for (let i = 0; i < word.length; i++) {
                    let r, c;
                    if (direction === "across") {
                        r = start_y;
                        c = start_x + i;
                    } else { // down
                        r = start_y + i;
                        c = start_x;
                    }

                    if (r < GRID_SIZE && c < GRID_SIZE) {
                        const cellIndex = r * GRID_SIZE + c;
                        const cellElement = crosswordGridElement.children[cellIndex];
                        cellElement.classList.remove('empty');
                        cellElement.innerHTML = `<input type="text" maxlength="1" data-word-id="${id}" data-letter-index="${i}" data-direction="${direction}" data-start-x="${start_x}" data-start-y="${start_y}">`;
                        
                        // A√±adir n√∫mero de pista solo a la primera letra
                        if (i === 0) {
                            const clueNumberSpan = document.createElement('span');
                            clueNumberSpan.classList.add('clue-number');
                            clueNumberSpan.textContent = id;
                            cellElement.appendChild(clueNumberSpan);
                        }
                    }
                }
            });

            // Generar pistas
            cluesAcrossElement.innerHTML = '';
            cluesDownElement.innerHTML = '';
            crosswordData.forEach(wordData => {
                const li = document.createElement('li');
                li.textContent = `${wordData.id}. ${wordData.clue}`;
                if (wordData.direction === "across") {
                    cluesAcrossElement.appendChild(li);
                } else {
                    cluesDownElement.appendChild(li);
                }
            });
        }

        function checkCrossword() {
            let allCorrect = true;
            crosswordData.forEach(wordData => {
                const { id, word, direction, start_x, start_y } = wordData;
                let userAnswer = "";
                let wordCells = [];

                for (let i = 0; i < word.length; i++) {
                    let r, c;
                    if (direction === "across") {
                        r = start_y;
                        c = start_x + i;
                    } else { // down
                        r = start_y + i;
                        c = start_x;
                    }
                    const cellIndex = r * GRID_SIZE + c;
                    const cellElement = crosswordGridElement.children[cellIndex];
                    const inputElement = cellElement.querySelector('input');
                    if (inputElement) {
                        userAnswer += inputElement.value.toUpperCase();
                        wordCells.push(inputElement);
                    }
                }

                if (userAnswer === word) {
                    wordCells.forEach(input => {
                        input.classList.remove('incorrect-word');
                        input.classList.add('correct-word');
                        input.disabled = true; // Deshabilitar si es correcta
                    });
                } else {
                    wordCells.forEach(input => {
                        input.classList.remove('correct-word');
                        input.classList.add('incorrect-word');
                    });
                    allCorrect = false;
                }
            });

            if (allCorrect) {
                // Usar un modal personalizado en un entorno real
                alert("¬°Felicidades! ¬°Has completado el crucigrama correctamente!");
            } else {
                // Usar un modal personalizado en un entorno real
                alert("Hay algunas respuestas incorrectas. ¬°Sigue intent√°ndolo!");
            }
        }

        function resetCrossword() {
            generateCrosswordGrid(); // Regenera la cuadr√≠cula para resetear
        }

        // Event Listeners para los botones
        checkCrosswordBtn.addEventListener('click', checkCrossword);
        resetCrosswordBtn.addEventListener('click', resetCrossword);

        // Inicializar el crucigrama al cargar la p√°gina
        window.onload = function() {
            generateCrosswordGrid();
            // Funci√≥n para reproducir un fragmento de audiolibro (simulado)
            // En un entorno real, aqu√≠ cargar√≠as un archivo de audio o usar√≠as una API de audio.
            // Por la limitaci√≥n de no usar URLs externas de audio, esto es solo un placeholder.
            function playAmbientAudio() {
                console.log("Simulando reproducci√≥n de audiolibro para ambientar la clase.");
                // Podr√≠as mostrar un mensaje en pantalla al usuario para que reproduzca un audiolibro externo.
            }
            playAmbientAudio();
        };
    </script>
</body>
</html>
